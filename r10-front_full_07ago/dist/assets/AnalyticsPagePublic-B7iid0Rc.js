import{j as e,R as s,k as t,C as a,X as i,Y as r,T as o,m as l,L as n,n as d,B as c,o as x,P as m,p as u,q as g,h}from"./admin-Cpxqs_4t.js";import{r as p}from"./vendor-Bfak-lhW.js";import{q as v,$ as j,I as f,J as b,b as y,n as w,s as k,A as N}from"./icons-C9jemfr7.js";const S="#ef4444",z="#3b82f6",R="#10b981",D="#f59e0b",C="#e1306c",F="#1877f2",L=({title:s,value:t,change:a,icon:i,color:r,description:o})=>e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg border border-gray-100 hover:shadow-xl transition-all duration-300",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:`p-3 rounded-full bg-gradient-to-r ${r}`,children:i}),a&&e.jsxs("div",{className:"flex items-center text-sm font-medium "+(a.startsWith("+")?"text-green-600":a.startsWith("-")?"text-red-600":"text-gray-600"),children:[e.jsx(k,{size:16,className:"mr-1"}),a]})]}),e.jsx("h3",{className:"text-gray-600 text-sm font-medium mb-1",children:s}),e.jsx("p",{className:"text-3xl font-bold text-gray-900 mb-1",children:t}),o&&e.jsx("p",{className:"text-xs text-gray-500",children:o})]}),P=({title:s,children:t,className:a=""})=>e.jsxs("div",{className:`bg-white rounded-xl p-6 shadow-lg border border-gray-100 ${a}`,children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(N,{size:20,className:"mr-2 text-red-500"}),s]}),e.jsx("div",{className:"h-80",children:t})]}),$=()=>{var k,N,$;const[K,I]=p.useState(null),[G,O]=p.useState(!0),[W,B]=p.useState(null),[A,T]=p.useState(30),U=async()=>{O(!0),B(null);try{const[e,s]=await Promise.all([h(`/social/analytics?days=${A}`).catch(()=>null),h(`/site/analytics?days=${A}`).catch(()=>null)]);I({social:e||{instagram:{account:{id:"",username:""},metrics:[]},facebook:{account:{id:"",name:""},metrics:[]}},site:s||{metrics:{pageviews:[],sessions:[],users:[]},topPages:[]}})}catch(e){B((null==e?void 0:e.message)||"Erro ao carregar analytics")}finally{O(!1)}};if(p.useEffect(()=>{U()},[A]),G)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 p-6",children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsxs("div",{className:"animate-pulse space-y-6",children:[e.jsx("div",{className:"h-8 bg-gray-300 rounded w-64"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[...Array(4)].map((s,t)=>e.jsx("div",{className:"h-32 bg-gray-300 rounded-xl"},t))}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[...Array(4)].map((s,t)=>e.jsx("div",{className:"h-96 bg-gray-300 rounded-xl"},t))})]})})});if(W)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white rounded-xl p-8 shadow-lg text-center max-w-md",children:[e.jsx("div",{className:"text-red-500 mb-4",children:e.jsx(v,{size:48,className:"mx-auto"})}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Erro ao Carregar Analytics"}),e.jsx("p",{className:"text-gray-600 mb-4",children:W}),e.jsx("button",{onClick:U,className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors",children:"Tentar Novamente"})]})});const E=(()=>{var e,s,t;const a=null==K?void 0:K.social.instagram,i=null==K?void 0:K.social.facebook,r=(null==(e=null==a?void 0:a.metrics.find(e=>"reach"===e.name&&"ok"===e.status))?void 0:e.series)||[],o=(null==(s=null==a?void 0:a.metrics.find(e=>"views"===e.name&&"ok"===e.status))?void 0:s.series)||[],l=(null==(t=null==i?void 0:i.metrics.find(e=>"page_impressions"===e.name&&"ok"===e.status))?void 0:t.series)||[];return{igReachTotal:r.reduce((e,s)=>e+s.value,0),igViewsTotal:o.reduce((e,s)=>e+s.value,0),fbImpressionsTotal:l.reduce((e,s)=>e+s.value,0),igFollowers:(null==a?void 0:a.account.followers)||0,fbFollowers:(null==i?void 0:i.account.followers)||0}})(),q=(()=>{const e=null==K?void 0:K.site.metrics;return{totalPageviews:(null==e?void 0:e.pageviews.reduce((e,s)=>e+s.value,0))||0,totalSessions:(null==e?void 0:e.sessions.reduce((e,s)=>e+s.value,0))||0,totalUsers:(null==e?void 0:e.users.reduce((e,s)=>e+s.value,0))||0,avgSessionPages:(null==e?void 0:e.pageviews.length)&&(null==e?void 0:e.sessions.length)?Math.round(e.pageviews.reduce((e,s)=>e+s.value,0)/e.sessions.reduce((e,s)=>e+s.value,0)*100)/100:0}})(),M=(null==(N=null==(k=null==K?void 0:K.social.instagram.metrics.find(e=>"reach"===e.name))?void 0:k.series)?void 0:N.map((e,s)=>{var t,a,i;return{date:e.date,Instagram:e.value,Facebook:(null==(i=null==(a=null==(t=null==K?void 0:K.social.facebook.metrics.find(e=>"page_impressions"===e.name))?void 0:t.series)?void 0:a[s])?void 0:i.value)||0}}))||[],V=[{name:"Direto",value:45,color:S},{name:"Redes Sociais",value:30,color:C},{name:"Busca Orgânica",value:20,color:R},{name:"Outros",value:5,color:D}];return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100",children:[e.jsx("div",{className:"bg-white shadow-sm border-b border-gray-200",children:e.jsx("div",{className:"max-w-7xl mx-auto px-6 py-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center",children:[e.jsx(v,{size:32,className:"mr-3 text-red-500"}),"Analytics R10 Piauí"]}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Insights completos do site e redes sociais"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("select",{value:A,onChange:e=>T(Number(e.target.value)),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",children:[e.jsx("option",{value:7,children:"Últimos 7 dias"}),e.jsx("option",{value:14,children:"Últimos 14 dias"}),e.jsx("option",{value:30,children:"Últimos 30 dias"}),e.jsx("option",{value:60,children:"Últimos 60 dias"}),e.jsx("option",{value:90,children:"Últimos 90 dias"})]}),e.jsxs("button",{onClick:U,className:"px-6 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors flex items-center",children:[e.jsx(j,{size:16,className:"mr-2"}),"Atualizar"]})]})]})})}),e.jsxs("div",{className:"max-w-7xl mx-auto p-6 space-y-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(L,{title:"Seguidores Instagram",value:E.igFollowers.toLocaleString(),change:"+5.2%",icon:e.jsx(f,{size:24,className:"text-white"}),color:"from-pink-500 to-purple-600",description:`@${(null==K?void 0:K.social.instagram.account.username)||"r10piaui"}`}),e.jsx(L,{title:"Seguidores Facebook",value:E.fbFollowers.toLocaleString(),change:"+2.8%",icon:e.jsx(b,{size:24,className:"text-white"}),color:"from-blue-500 to-blue-700",description:(null==K?void 0:K.social.facebook.account.name)||"R10 Piauí"}),e.jsx(L,{title:"Pageviews",value:q.totalPageviews.toLocaleString(),change:"+12.3%",icon:e.jsx(y,{size:24,className:"text-white"}),color:"from-green-500 to-emerald-600",description:`${A} dias`}),e.jsx(L,{title:"Usuários Únicos",value:q.totalUsers.toLocaleString(),change:"+8.7%",icon:e.jsx(w,{size:24,className:"text-white"}),color:"from-orange-500 to-red-600",description:`${A} dias`})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(P,{title:"Tráfego do Site",children:e.jsx(s,{width:"100%",height:"100%",children:e.jsxs(t,{data:(null==K?void 0:K.site.metrics.pageviews)||[],children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"pageviewsGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:S,stopOpacity:.8}),e.jsx("stop",{offset:"95%",stopColor:S,stopOpacity:.1})]})}),e.jsx(a,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),e.jsx(i,{dataKey:"date",stroke:"#6b7280",fontSize:12,tickFormatter:e=>new Date(e).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"})}),e.jsx(r,{stroke:"#6b7280",fontSize:12}),e.jsx(o,{contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"8px"},formatter:e=>[e.toLocaleString(),"Pageviews"],labelFormatter:e=>new Date(e).toLocaleDateString("pt-BR")}),e.jsx(l,{type:"monotone",dataKey:"value",stroke:S,fillOpacity:1,fill:"url(#pageviewsGradient)",strokeWidth:2})]})})}),e.jsx(P,{title:"Alcance nas Redes Sociais",children:e.jsx(s,{width:"100%",height:"100%",children:e.jsxs(n,{data:M,children:[e.jsx(a,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),e.jsx(i,{dataKey:"date",stroke:"#6b7280",fontSize:12,tickFormatter:e=>new Date(e).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"})}),e.jsx(r,{stroke:"#6b7280",fontSize:12}),e.jsx(o,{contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"8px"},formatter:(e,s)=>[e.toLocaleString(),"Instagram"===s?"Reach":"Impressions"],labelFormatter:e=>new Date(e).toLocaleDateString("pt-BR")}),e.jsx(d,{type:"monotone",dataKey:"Instagram",stroke:C,strokeWidth:3,dot:{fill:C,strokeWidth:2,r:4}}),e.jsx(d,{type:"monotone",dataKey:"Facebook",stroke:F,strokeWidth:3,dot:{fill:F,strokeWidth:2,r:4}})]})})}),e.jsx(P,{title:"Páginas Mais Visitadas",children:e.jsx(s,{width:"100%",height:"100%",children:e.jsxs(c,{data:(null==K?void 0:K.site.topPages.slice(0,10))||[],layout:"horizontal",children:[e.jsx(a,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),e.jsx(i,{type:"number",stroke:"#6b7280",fontSize:12}),e.jsx(r,{type:"category",dataKey:"path",stroke:"#6b7280",fontSize:11,width:120,tickFormatter:e=>e.length>15?e.substring(0,15)+"...":e}),e.jsx(o,{contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"8px"},formatter:e=>[e.toLocaleString(),"Pageviews"]}),e.jsx(x,{dataKey:"pageviews",fill:R,radius:[0,4,4,0]})]})})}),e.jsx(P,{title:"Fontes de Tráfego",children:e.jsx(s,{width:"100%",height:"100%",children:e.jsxs(m,{children:[e.jsx(u,{data:V,cx:"50%",cy:"50%",outerRadius:100,fill:"#8884d8",dataKey:"value",label:({name:e,percent:s})=>`${e} ${(100*s).toFixed(0)}%`,children:V.map((s,t)=>e.jsx(g,{fill:s.color},`cell-${t}`))}),e.jsx(o,{contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"8px"},formatter:e=>[`${e}%`,"Porcentagem"]})]})})})]}),e.jsx(P,{title:"Sessões vs Usuários",className:"col-span-full",children:e.jsx(s,{width:"100%",height:"100%",children:e.jsxs(t,{data:(null==($=null==K?void 0:K.site.metrics.sessions)?void 0:$.map((e,s)=>{var t,a;return{date:e.date,"Sessões":e.value,"Usuários":(null==(a=null==(t=null==K?void 0:K.site.metrics.users)?void 0:t[s])?void 0:a.value)||0}}))||[],children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"sessionsGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:z,stopOpacity:.8}),e.jsx("stop",{offset:"95%",stopColor:z,stopOpacity:.1})]}),e.jsxs("linearGradient",{id:"usersGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:R,stopOpacity:.8}),e.jsx("stop",{offset:"95%",stopColor:R,stopOpacity:.1})]})]}),e.jsx(a,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),e.jsx(i,{dataKey:"date",stroke:"#6b7280",fontSize:12,tickFormatter:e=>new Date(e).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"})}),e.jsx(r,{stroke:"#6b7280",fontSize:12}),e.jsx(o,{contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"8px"},formatter:(e,s)=>[e.toLocaleString(),s],labelFormatter:e=>new Date(e).toLocaleDateString("pt-BR")}),e.jsx(l,{type:"monotone",dataKey:"Sessões",stackId:"1",stroke:z,fill:"url(#sessionsGradient)",strokeWidth:2}),e.jsx(l,{type:"monotone",dataKey:"Usuários",stackId:"2",stroke:R,fill:"url(#usersGradient)",strokeWidth:2})]})})})]})]})};export{$ as default};
